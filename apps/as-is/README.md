# As-Is: ç¾çŠ¶ã®é–‹ç™ºç’°å¢ƒãƒ»æ§‹æˆ

ç¾åœ¨ã®Dorapitaã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ç’°å¢ƒã®å®Ÿæ…‹ã‚’ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆåŒ–ã—ã¦ã„ã¾ã™ã€‚

---

## ğŸ“‹ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ§‹æˆ

### 1. ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒ
**ãƒ•ã‚¡ã‚¤ãƒ«**: [`local-development.md`](local-development.md)

**å†…å®¹**:
- Docker Composeç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †
- ã‚µãƒ¼ãƒ“ã‚¹ä¸€è¦§ã¨ãƒãƒ¼ãƒˆç•ªå·
- ç’°å¢ƒå¤‰æ•°è¨­å®š
- ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

**å¯¾è±¡ã‚µãƒ¼ãƒ“ã‚¹**:
- dorapita.com (ãƒãƒ¼ãƒˆ: 8080)
- cadm.dorapita.com (ãƒãƒ¼ãƒˆ: 8888)
- kanri.dorapita.com (ãƒãƒ¼ãƒˆ: 8088)
- dora-pt.jp (ãƒãƒ¼ãƒˆ: 9999)
- edit.dorapita.com (ãƒãƒ¼ãƒˆ: 9090)

### 2. Docker Composeèµ·å‹•è©³ç´°ã‚¬ã‚¤ãƒ‰
**ãƒ•ã‚¡ã‚¤ãƒ«**: [`how-to-up-docker-compose.md`](how-to-up-docker-compose.md)

**å†…å®¹**:
- ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆæ‰‹é †
- è©³ç´°ãªã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰
- ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼ã¨è§£æ±ºæ–¹æ³•
- DBã‚¹ã‚­ãƒ¼ãƒé©ç”¨æ–¹æ³•

### 3. ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£
**ãƒ•ã‚¡ã‚¤ãƒ«**: [`local-development-architecture.md`](local-development-architecture.md)

**å†…å®¹**:
- Docker Composeæ§‹æˆã®å…¨ä½“åƒ
- ã‚µãƒ¼ãƒ“ã‚¹é–“ã®ä¾å­˜é–¢ä¿‚
- ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ§‹æˆ
- ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼
- ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³ï¼ˆ`images/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼‰

### 4. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åˆ†æ
**ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª**: [`database-analysis/`](database-analysis/)

#### 4.1 STGãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åˆ†æãƒ¬ãƒãƒ¼ãƒˆ
**ãƒ•ã‚¡ã‚¤ãƒ«**: [`database-analysis/stg-database-analysis-report.md`](database-analysis/stg-database-analysis-report.md)

**ä¸»è¦ãªç™ºè¦‹**:
- **ç·ãƒ†ãƒ¼ãƒ–ãƒ«æ•°**: 113ãƒ†ãƒ¼ãƒ–ãƒ«
- **æœªä½¿ç”¨ãƒ†ãƒ¼ãƒ–ãƒ«**: 24ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆ21.2%ï¼‰
- **Fixtureå„ªå…ˆåº¦**: é«˜ï¼ˆ56ãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰ã€ä¸­ï¼ˆ17ãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰ã€ä½ï¼ˆ16ãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰

**é‡è¦ãªãƒ†ãƒ¼ãƒ–ãƒ«ã‚°ãƒ«ãƒ¼ãƒ—**:
- **æ±‚äººé–¢é€£**: `recruitments`, `recruitment_details`, `companies` ç­‰
- **å¿œå‹Ÿé–¢é€£**: `applications`, `application_histories` ç­‰
- **èªè¨¼**: `admin_users`, `company_users` ç­‰
- **ãƒã‚¹ã‚¿**: `prefectures`, `cities`, `routes` ç­‰

#### 4.2 ãƒ†ãƒ¼ãƒ–ãƒ«ä½¿ç”¨çŠ¶æ³ãƒ¬ãƒãƒ¼ãƒˆ
**ãƒ•ã‚¡ã‚¤ãƒ«**: [`database-analysis/table-usage-report.md`](database-analysis/table-usage-report.md)

**åˆ†æå†…å®¹**:
- ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã§ã®ãƒ†ãƒ¼ãƒ–ãƒ«å‚ç…§ç®‡æ‰€
- ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ†ãƒ¼ãƒ–ãƒ« vs æœªä½¿ç”¨ãƒ†ãƒ¼ãƒ–ãƒ«
- ãƒ¬ã‚¬ã‚·ãƒ¼ã‚³ãƒ¼ãƒ‰ï¼ˆCakePHP 1.3ï¼‰ã®å½±éŸ¿
- å‰Šé™¤å€™è£œãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒªã‚¹ãƒˆ

---

## ğŸ—ï¸ ç¾çŠ¶ã®æ§‹æˆæ¦‚è¦

### Docker Composeç’°å¢ƒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒï¼ˆDocker Composeï¼‰          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                     â”‚
â”‚  Web Services:                                      â”‚
â”‚  â”œâ”€ dorapita.com        (8080)  CakePHP 4.4         â”‚
â”‚  â”œâ”€ cadm.dorapita.com   (8888)  CakePHP 4.5         â”‚
â”‚  â”œâ”€ kanri.dorapita.com  (8088)  CakePHP 4.x         â”‚
â”‚  â”œâ”€ dora-pt.jp          (9999)  CakePHP 4.x         â”‚
â”‚  â””â”€ edit.dorapita.com   (9090)  CakePHP 4.x         â”‚
â”‚                                                     â”‚
â”‚  Data Services:                                     â”‚
â”‚  â”œâ”€ PostgreSQL 10       (5432)  dorapita DB         â”‚
â”‚  â”œâ”€ MySQL 5.7          (3306)  kanri DB            â”‚
â”‚  â”œâ”€ Redis              (6379)  ã‚­ãƒ£ãƒƒã‚·ãƒ¥           â”‚
â”‚  â””â”€ MailHog            (8025)  ãƒ¡ãƒ¼ãƒ«ç¢ºèª           â”‚
â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ§‹æˆ

| DBç¨®åˆ¥ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | ä¸»è¦DBå | ä¸»è¦ã‚µãƒ¼ãƒ“ã‚¹ |
|--------|-----------|---------|-------------|
| PostgreSQL | 10 (EOL) | dorapita | dorapita.com, cadm, edit |
| MySQL | 5.7 (å»¶é•·ã‚µãƒãƒ¼ãƒˆ) | dorapita1804 | kanri.dorapita.com |

### ä¸»è¦ãªæŠ€è¡“çš„èª²é¡Œ

1. **DBäºŒé‡ç®¡ç†**
   - PostgreSQL â‡„ MySQL ã®åŒæœŸãƒãƒƒãƒï¼ˆ1åˆ†é–“éš”ï¼‰
   - N+1ã‚¯ã‚¨ãƒªå•é¡Œï¼ˆ501å›ã®SQLç™ºè¡Œï¼‰
   - ç¬æ–­ã®ä¸»è¦å› 

2. **DBãƒãƒ¼ã‚¸ãƒ§ãƒ³EOL**
   - PostgreSQL 10: 2022å¹´11æœˆã«EOL
   - MySQL 5.7: å»¶é•·ã‚µãƒãƒ¼ãƒˆä¸­ï¼ˆÂ¥13.7ä¸‡å††/æœˆï¼‰

3. **CakePHPãƒãƒ¼ã‚¸ãƒ§ãƒ³æ··åœ¨**
   - 4.4, 4.5, 5.2 ãŒæ··åœ¨
   - legacy: 1.3.21 (PHP 5.6)

4. **Fixtureæœªæ•´å‚™**
   - ãƒ†ã‚¹ãƒˆç”¨ãƒ‡ãƒ¼ã‚¿ãŒä¸è¶³
   - æ–°è¦é–‹ç™ºè€…ã®ã‚ªãƒ³ãƒœãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã«æ™‚é–“ãŒã‹ã‹ã‚‹

---

## ğŸ“Š ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çµ±è¨ˆ

### ãƒ†ãƒ¼ãƒ–ãƒ«åˆ†é¡

| åˆ†é¡ | ãƒ†ãƒ¼ãƒ–ãƒ«æ•° | å‰²åˆ |
|------|-----------|------|
| ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ï¼ˆã‚³ãƒ¼ãƒ‰ã‹ã‚‰å‚ç…§ã‚ã‚Šï¼‰ | 89 | 78.8% |
| æœªä½¿ç”¨ï¼ˆã‚³ãƒ¼ãƒ‰å‚ç…§ãªã—ï¼‰ | 24 | 21.2% |
| **åˆè¨ˆ** | **113** | **100%** |

### Fixtureå„ªå…ˆåº¦

| å„ªå…ˆåº¦ | ãƒ†ãƒ¼ãƒ–ãƒ«æ•° | ä¸»è¦ãƒ†ãƒ¼ãƒ–ãƒ« |
|--------|-----------|-------------|
| **é«˜** | 56 | recruitments, applications, companies, admin_users |
| **ä¸­** | 17 | recruitment_images, application_histories, prefectures |
| **ä½** | 16 | logs, api_logs, batches |
| ä¸è¦ | 24 | legacy_*, æœªä½¿ç”¨ãƒ†ãƒ¼ãƒ–ãƒ« |

### æœªä½¿ç”¨ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆå‰Šé™¤å€™è£œï¼‰

- `backup_*` ç³»ï¼ˆ5ãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰
- `tmp_*` ç³»ï¼ˆ4ãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰
- `legacy_*` ç³»ï¼ˆ3ãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰
- ãã®ä»–ï¼ˆ12ãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰

è©³ç´°: [`database-analysis/table-usage-report.md`](database-analysis/table-usage-report.md)

---

## ğŸ” é–¢é€£ã™ã‚‹é‡è¦èª²é¡Œ

### DBäºŒé‡ç®¡ç†ãƒªã‚¹ã‚¯
â†’ [`../important_issues/DB_INTEGRATION_TECHNICAL_RISK_REPORT.md`](../important_issues/DB_INTEGRATION_TECHNICAL_RISK_REPORT.md)

- ç¬æ–­ç™ºç”Ÿï¼ˆé€±10ã€œ20å›ï¼‰
- å¹´é–“ä¿å®ˆã‚³ã‚¹ãƒˆå¢—: ç´„700ä¸‡å††

### ã‚µãƒ¼ãƒãƒ¼ã‚³ã‚¹ãƒˆå‰Šæ¸›
â†’ [`../important_issues/SERVER_COST_REDUCTION_REPORT.md`](../important_issues/SERVER_COST_REDUCTION_REPORT.md)

- MySQL 8.0ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã§æœˆÂ¥13.7ä¸‡å††å‰Šæ¸›å¯èƒ½

---

## ğŸ¯ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

ç¾çŠ¶ï¼ˆAs-Isï¼‰ã‚’ç†è§£ã—ãŸå¾Œã¯ã€æ”¹å–„æˆ¦ç•¥ï¼ˆTo-Beï¼‰ã‚’ç¢ºèªã—ã¦ãã ã•ã„:

â†’ [`../to-be/`](../to-be/) - é–‹ç™ºç’°å¢ƒæ”¹å–„æˆ¦ç•¥

---

**æœ€çµ‚æ›´æ–°**: 2025-12-28  
**ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹**: Docker Compose, ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åˆ†æ, ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹èª¿æŸ»
